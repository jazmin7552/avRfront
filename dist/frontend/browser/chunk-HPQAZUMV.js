import{a as N}from"./chunk-IRBKGEKH.js";import"./chunk-2QYJB2GK.js";import{a as T}from"./chunk-AFD7EEFG.js";import"./chunk-XQHYLHBR.js";import{$ as g,B as r,Da as y,F as f,G as M,K as v,O as l,P as n,Q as o,R as _,S as u,T as m,U as s,X as C,Z as a,_ as p,a as P,b as O,ga as h,ha as E,pa as w,qa as A,ra as k,s as b,sa as S,t as x,ta as D,ua as I}from"./chunk-BCLJKQU2.js";function F(i,t){i&1&&(n(0,"div",15),_(1,"div",16),n(2,"p"),a(3,"Cargando comandas..."),o()())}function V(i,t){if(i&1&&(n(0,"div",61)(1,"span",62),a(2),o(),n(3,"span",63),a(4),o()()),i&2){let e=t.$implicit;r(2),g("",e.cantidad,"x"),r(2),p(e.nombreProducto||"Producto")}}function R(i,t){if(i&1&&(n(0,"span",64),a(1),o()),i&2){let e=s(2).$implicit;r(),g(" +",e.detalles.length-3," m\xE1s... ")}}function j(i,t){if(i&1&&(n(0,"div",56)(1,"div",57)(2,"span"),a(3),o()(),n(4,"div",58),v(5,V,5,2,"div",59)(6,R,2,1,"span",60),o()()),i&2){let e=s().$implicit;r(3),g("\u{1F4E6} ",e.detalles.length," producto(s)"),r(2),l("ngForOf",e.detalles.slice(0,3)),r(),l("ngIf",e.detalles.length>3)}}function G(i,t){if(i&1){let e=u();n(0,"div",35)(1,"div",36),m("click",function(){let c=b(e).$implicit,L=s(2);return x(L.verDetalleComanda(c))}),n(2,"div",37)(3,"div",38)(4,"div",39)(5,"span",40),a(6,"Comanda"),o(),n(7,"span",41),a(8),o()(),n(9,"div",42)(10,"span",43),a(11),o(),n(12,"span",44),a(13),o()()(),n(14,"div",45)(15,"div",46)(16,"div",47)(17,"span",48),a(18,"\u{1FA91}"),o(),n(19,"span",49),a(20),o()(),n(21,"div",47)(22,"span",48),a(23,"\u{1F550}"),o(),n(24,"span",49),a(25),h(26,"date"),o()()(),v(27,j,7,3,"div",50),o(),n(28,"div",51)(29,"div",52)(30,"span",53),a(31,"Total:"),o(),n(32,"span",54),a(33),h(34,"number"),o()(),n(35,"button",55),a(36,"Ver Detalle \u2192"),o()()()()()}if(i&2){let e=t.$implicit,d=s(2);r(8),g("#",e.comandaId),r(),l("ngClass",d.getEstadoClase(e.estadoNombre)),r(2),p(d.getEstadoIcono(e.estadoNombre)),r(2),p(d.getEstadoTexto(e.estadoNombre)),r(7),g("Mesa ",e.mesaId),r(5),p(E(26,8,e.fecha,"HH:mm")),r(2),l("ngIf",e.detalles&&e.detalles.length>0),r(6),g("$",E(34,11,d.calcularTotalComanda(e),"1.0-0"))}}function $(i,t){if(i&1){let e=u();n(0,"div",65)(1,"div",66)(2,"div",67),a(3,"\u{1F4ED}"),o(),n(4,"p",68),a(5),o(),n(6,"button",69),m("click",function(){b(e);let c=s(2);return x(c.volver())}),a(7," Volver al Dashboard "),o()()()}if(i&2){let e=s(2);r(5),g(" ",e.filtroEstado==="TODAS"?"No tienes comandas activas en este momento":"No hay comandas "+e.getEstadoTexto(e.filtroEstado).toLowerCase()," ")}}function B(i,t){if(i&1){let e=u();n(0,"div",17)(1,"div",18)(2,"section",19)(3,"div",20)(4,"div",21)(5,"div",22)(6,"div",23)(7,"div",24),a(8,"\u{1F4CA}"),o(),n(9,"div",25)(10,"p",26),a(11,"Total Activas"),o(),n(12,"p",27),a(13),o()()()()(),n(14,"div",21)(15,"div",28)(16,"div",23)(17,"div",24),a(18,"\u23F3"),o(),n(19,"div",25)(20,"p",26),a(21,"Pendientes"),o(),n(22,"p",27),a(23),o()()()()(),n(24,"div",21)(25,"div",29)(26,"div",23)(27,"div",24),a(28,"\u2705"),o(),n(29,"div",25)(30,"p",26),a(31,"Listas para Entregar"),o(),n(32,"p",27),a(33),o()()()()()()(),n(34,"section",19)(35,"div",30)(36,"button",31),m("click",function(){b(e);let c=s();return x(c.filtrarPorEstado("TODAS"))}),a(37," \u{1F4CB} Todas "),o(),n(38,"button",31),m("click",function(){b(e);let c=s();return x(c.filtrarPorEstado("PENDIENTE"))}),a(39," \u23F3 Pendientes "),o(),n(40,"button",31),m("click",function(){b(e);let c=s();return x(c.filtrarPorEstado("LISTA"))}),a(41," \u2705 Listas "),o()()(),n(42,"section")(43,"div",32),v(44,G,37,14,"div",33)(45,$,8,1,"div",34),o()()()()}if(i&2){let e=s();r(13),p(e.contadores.total),r(10),p(e.contadores.pendientes),r(10),p(e.contadores.listas),r(3),C("active",e.filtroEstado==="TODAS"),r(2),C("active",e.filtroEstado==="PENDIENTE"),r(2),C("active",e.filtroEstado==="LISTA"),r(4),l("ngForOf",e.comandasFiltradas),r(),l("ngIf",e.comandasFiltradas.length===0)}}var z=class i{constructor(t,e,d){this.comandaService=t;this.router=e;this.authService=d}comandas=[];comandasFiltradas=[];loading=!0;filtroEstado="TODAS";contadores={pendientes:0,listas:0,total:0};ngOnInit(){this.cargarComandas()}cargarComandas(){this.loading=!0,this.comandaService.getMisComandasActivas().subscribe({next:t=>{console.log("\u{1F4E6} MIS COMANDAS ACTIVAS RECIBIDAS:",t),this.comandas=t.map(e=>O(P({},e),{estadoNombre:this.normalizarEstado(e.estadoNombre||e.estadoId)})),this.calcularContadores(),this.aplicarFiltro(),this.loading=!1},error:t=>{console.error("\u274C Error al cargar comandas activas:",t),this.loading=!1,t.status===401||t.status===403?(alert("Sesi\xF3n expirada. Por favor inicia sesi\xF3n nuevamente."),this.router.navigate(["/login"])):alert("Error al cargar las comandas activas")}})}normalizarEstado(t){if(typeof t=="number")return{4:"PENDIENTE",5:"LISTA",6:"ENTREGADA",7:"CANCELADA"}[t]||"DESCONOCIDO";if(typeof t=="string"){let e=t.toUpperCase().trim();return e.includes("PENDIENTE")?"PENDIENTE":e.includes("LISTA")?"LISTA":e.includes("ENTREGADA")?"ENTREGADA":e.includes("CANCELADA")?"CANCELADA":e}return"DESCONOCIDO"}calcularContadores(){this.contadores.pendientes=this.comandas.filter(t=>t.estadoNombre==="PENDIENTE").length,this.contadores.listas=this.comandas.filter(t=>t.estadoNombre==="LISTA").length,this.contadores.total=this.comandas.length}filtrarPorEstado(t){this.filtroEstado=t,this.aplicarFiltro()}aplicarFiltro(){this.filtroEstado==="TODAS"?this.comandasFiltradas=[...this.comandas]:this.comandasFiltradas=this.comandas.filter(t=>t.estadoNombre===this.filtroEstado)}verDetalleComanda(t){t.mesaId?this.router.navigate(["/mesero/ver-cuenta",t.mesaId]):t.comandaId&&this.router.navigate(["/mesero/comanda",t.comandaId])}getEstadoClase(t){return{PENDIENTE:"estado-pendiente",LISTA:"estado-lista",ENTREGADA:"estado-entregada",CANCELADA:"estado-cancelada"}[t]||""}getEstadoTexto(t){return{PENDIENTE:"Pendiente",LISTA:"Lista para Entregar",ENTREGADA:"Entregada",CANCELADA:"Cancelada"}[t]||t}getEstadoIcono(t){return{PENDIENTE:"\u23F3",LISTA:"\u2705",ENTREGADA:"\u{1F389}",CANCELADA:"\u274C"}[t]||"\u{1F4CB}"}calcularTotalComanda(t){return t.detalles&&Array.isArray(t.detalles)?t.detalles.reduce((e,d)=>e+(d.subtotal||0),0):t.total||0}volver(){this.router.navigate(["/mesero/dashboard"])}refrescar(){this.cargarComandas()}static \u0275fac=function(e){return new(e||i)(f(N),f(y),f(T))};static \u0275cmp=M({type:i,selectors:[["app-comandas-activas"]],decls:18,vars:2,consts:[[1,"comandas-container"],[1,"decorative-corner","corner-tl"],[1,"decorative-corner","corner-tr"],[1,"decorative-corner","corner-bl"],[1,"decorative-corner","corner-br"],[1,"comandas-header"],[1,"container-fluid","px-3","px-md-4","py-3"],[1,"row","align-items-center","g-3"],[1,"col-12","col-md-6","d-flex","align-items-center","gap-3"],[1,"btn","btn-back","rounded-pill",3,"click"],[1,"mb-0"],[1,"col-12","col-md-6","text-md-end"],[1,"btn","btn-refresh","rounded-pill",3,"click"],["class","loading",4,"ngIf"],["class","main-content",4,"ngIf"],[1,"loading"],[1,"spinner"],[1,"main-content"],[1,"container-fluid","px-3","px-md-4","py-4"],[1,"mb-4"],[1,"row","g-3","g-md-4","justify-content-center"],[1,"col-12","col-sm-6","col-lg-4"],[1,"card","contador-card","border-0","h-100"],[1,"card-body","p-3","p-md-4","d-flex","align-items-center","gap-3"],[1,"contador-icon"],[1,"contador-info","flex-grow-1"],[1,"contador-label","mb-1"],[1,"contador-valor","mb-0"],[1,"card","contador-card","pendiente","border-0","h-100"],[1,"card","contador-card","lista","border-0","h-100"],[1,"d-flex","flex-wrap","gap-2","gap-md-3","justify-content-center"],[1,"btn","btn-filtro",3,"click"],[1,"row","g-3","g-md-4"],["class","col-12 col-md-6 col-xl-4",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"col-12","col-md-6","col-xl-4"],[1,"card","comanda-card","border-0","h-100",3,"click"],[1,"card-body","p-3","p-md-4"],[1,"comanda-header","d-flex","justify-content-between","align-items-start","mb-3","pb-3"],[1,"comanda-numero"],[1,"numero-label","d-block"],[1,"numero-valor","d-block"],[1,"comanda-estado","d-flex","align-items-center","gap-2","px-3","py-2",3,"ngClass"],[1,"estado-icon"],[1,"estado-texto"],[1,"comanda-body","mb-3"],[1,"d-flex","gap-4","mb-3"],[1,"info-item","d-flex","align-items-center","gap-2"],[1,"info-icon"],[1,"info-text"],["class","comanda-productos p-3",4,"ngIf"],[1,"comanda-footer","d-flex","justify-content-between","align-items-center","pt-3"],[1,"comanda-total"],[1,"total-label","d-block"],[1,"total-valor","d-block"],[1,"btn","btn-ver-detalle","rounded-pill"],[1,"comanda-productos","p-3"],[1,"productos-header","mb-2"],[1,"productos-preview","d-flex","flex-column","gap-2"],["class","producto-preview-item d-flex gap-2",4,"ngFor","ngForOf"],["class","productos-mas",4,"ngIf"],[1,"producto-preview-item","d-flex","gap-2"],[1,"producto-cantidad"],[1,"producto-nombre"],[1,"productos-mas"],[1,"col-12"],[1,"empty-state","d-flex","flex-column","align-items-center","gap-3","py-5"],[1,"empty-icon"],[1,"empty-text","mb-3"],[1,"btn","btn-empty-action","rounded-pill",3,"click"]],template:function(e,d){e&1&&(n(0,"div",0),_(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),n(5,"header",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"button",9),m("click",function(){return d.volver()}),a(10," \u2190 Volver "),o(),n(11,"h1",10),a(12,"\u{1F4CB} Comandas Activas"),o()(),n(13,"div",11)(14,"button",12),m("click",function(){return d.refrescar()}),a(15," \u{1F504} Actualizar "),o()()()()(),v(16,F,4,0,"div",13)(17,B,46,11,"div",14),o()),e&2&&(r(16),l("ngIf",d.loading),r(),l("ngIf",!d.loading))},dependencies:[I,w,A,k,D,S],styles:['@import"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css";[_ngcontent-%COMP%]:root{--bs-primary: #d4a574;--bs-secondary: #b88652;--bs-success: #4caf50;--bs-danger: #e74c3c;--bs-warning: #ffc107;--bs-info: #42a5f5;--bs-light: #e0d5c7;--bs-dark: #0a0705;--bs-body-bg: #1a1410;--bs-body-color: #e0d5c7;--bs-border-color: rgba(212, 165, 116, .3);--bs-border-radius: 15px;--bs-font-sans-serif: "Cormorant Garamond", "Georgia", serif}*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;overflow:hidden;font-family:var(--bs-font-sans-serif)}.comandas-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;max-height:100vh;overflow:hidden;background:linear-gradient(135deg,#2d1f16f2,#1a1410f2);position:relative}.comandas-container[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background:radial-gradient(circle at 20% 30%,rgba(212,165,116,.08) 0%,transparent 50%),radial-gradient(circle at 80% 70%,rgba(212,165,116,.05) 0%,transparent 50%);pointer-events:none;z-index:0}.decorative-corner[_ngcontent-%COMP%]{position:fixed;width:120px;height:120px;border:1.5px solid rgba(212,165,116,.25);z-index:5;pointer-events:none}.corner-tl[_ngcontent-%COMP%]{top:15px;left:15px;border-right:none;border-bottom:none}.corner-tr[_ngcontent-%COMP%]{top:15px;right:15px;border-left:none;border-bottom:none}.corner-bl[_ngcontent-%COMP%]{bottom:15px;left:15px;border-right:none;border-top:none}.corner-br[_ngcontent-%COMP%]{bottom:15px;right:15px;border-left:none;border-top:none}.comandas-header[_ngcontent-%COMP%]{position:sticky;top:0;background:linear-gradient(135deg,#2d1f16fa,#1a1410fa);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid var(--bs-border-color);z-index:100;box-shadow:0 4px 30px #0000004d;flex-shrink:0}.comandas-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#e0b588;font-size:1.6rem;font-weight:400;letter-spacing:2px;margin:0}.btn-back[_ngcontent-%COMP%]{background:transparent;color:var(--bs-primary);border:1px solid rgba(212,165,116,.4);transition:all .3s ease}.btn-back[_ngcontent-%COMP%]:hover{background:#d4a5741a;border-color:var(--bs-primary);color:var(--bs-primary);transform:translate(-3px)}.btn-refresh[_ngcontent-%COMP%]{background:linear-gradient(135deg,#c89b68,#d4a574);color:#1a1410;border:none;font-weight:700;transition:all .3s ease}.btn-refresh[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 20px #d4a57466;color:#1a1410}.loading[_ngcontent-%COMP%]{text-align:center;padding:5rem 2rem;color:#e0b588}.spinner[_ngcontent-%COMP%]{border:3px solid rgba(212,165,116,.2);border-top:3px solid var(--bs-primary);border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;position:relative;z-index:10;min-height:0}.main-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:14px}.main-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#1a1410cc;border-radius:10px;margin:5px;box-shadow:inset 0 0 10px #00000080}.main-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#c89b68,#d4a574);border-radius:10px;border:2px solid rgba(26,20,16,.5);box-shadow:0 0 10px #d4a57480;transition:all .3s ease}.main-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#d4a574,#e0b588);box-shadow:0 0 15px #d4a574cc}.main-content[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#d4a574 rgba(26,20,16,.8)}.contador-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2d1f16b3,#1a1410b3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid var(--bs-border-color);transition:all .4s ease}.contador-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 30px #d4a57433}.contador-card.pendiente[_ngcontent-%COMP%]{border-color:#ffc10766}.contador-card.preparacion[_ngcontent-%COMP%]{border-color:#2196f366}.contador-card.lista[_ngcontent-%COMP%]{border-color:#4caf5066}.contador-icon[_ngcontent-%COMP%]{font-size:2.5rem;filter:drop-shadow(0 0 10px rgba(212,165,116,.3))}.contador-label[_ngcontent-%COMP%]{color:#b8a896;font-size:.9rem;text-transform:uppercase;letter-spacing:1px;margin:0}.contador-valor[_ngcontent-%COMP%]{color:#e0b588;font-size:2rem;font-weight:700;margin:.2rem 0 0;text-shadow:0 0 15px rgba(212,165,116,.3)}.btn-filtro[_ngcontent-%COMP%]{padding:.8rem 1.8rem;background:#1a141099;border:1px solid var(--bs-border-color);border-radius:25px;color:#b8a896;font-weight:600;font-size:.95rem;letter-spacing:.5px;transition:all .3s ease}.btn-filtro[_ngcontent-%COMP%]:hover{background:#d4a5741a;border-color:var(--bs-primary);color:#e0b588}.btn-filtro.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#c89b68,#d4a574);border-color:var(--bs-primary);color:#1a1410;box-shadow:0 6px 20px #d4a5744d}.comanda-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2d1f16cc,#1a1410cc);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid var(--bs-border-color);border-radius:20px;cursor:pointer;transition:all .4s ease;position:relative;overflow:hidden}.comanda-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(212,165,116,.1),transparent);transition:left .6s}.comanda-card[_ngcontent-%COMP%]:hover:before{left:100%}.comanda-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px) scale(1.02);border-color:var(--bs-primary);box-shadow:0 15px 40px #d4a5744d}.comanda-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(212,165,116,.2)}.numero-label[_ngcontent-%COMP%]{color:#b8a896;font-size:.8rem;text-transform:uppercase;letter-spacing:1px}.numero-valor[_ngcontent-%COMP%]{color:#e0b588;font-size:1.4rem;font-weight:700;letter-spacing:.5px}.comanda-estado[_ngcontent-%COMP%]{border-radius:20px;font-size:.85rem;font-weight:600;letter-spacing:.5px}.estado-icon[_ngcontent-%COMP%]{font-size:1.2rem}.estado-pendiente[_ngcontent-%COMP%]{background:#ffc10733;color:var(--bs-warning);border:1px solid rgba(255,193,7,.4)}.estado-preparacion[_ngcontent-%COMP%]{background:#2196f333;color:var(--bs-info);border:1px solid rgba(33,150,243,.4)}.estado-lista[_ngcontent-%COMP%]{background:#4caf5033;color:#81c784;border:1px solid rgba(76,175,80,.4)}.info-item[_ngcontent-%COMP%]{color:#b8a896;font-size:.95rem}.info-icon[_ngcontent-%COMP%]{font-size:1.2rem}.comanda-productos[_ngcontent-%COMP%]{background:#1a141080;border:1px solid rgba(212,165,116,.2);border-radius:12px}.productos-header[_ngcontent-%COMP%]{color:var(--bs-primary);font-size:.9rem;font-weight:600;letter-spacing:.5px}.producto-cantidad[_ngcontent-%COMP%]{color:#e0b588;font-weight:700;min-width:30px}.producto-nombre[_ngcontent-%COMP%]{color:#b8a896}.productos-mas[_ngcontent-%COMP%]{color:var(--bs-primary);font-size:.85rem;font-style:italic}.comanda-footer[_ngcontent-%COMP%]{border-top:1px solid rgba(212,165,116,.2)}.total-label[_ngcontent-%COMP%]{color:#b8a896;font-size:.8rem;text-transform:uppercase;letter-spacing:1px}.total-valor[_ngcontent-%COMP%]{color:#e0b588;font-size:1.5rem;font-weight:700;text-shadow:0 0 15px rgba(212,165,116,.3)}.btn-ver-detalle[_ngcontent-%COMP%]{background:linear-gradient(135deg,#c89b68,#d4a574);color:#1a1410;border:none;font-weight:700;font-size:.9rem;letter-spacing:.5px;transition:all .3s ease}.btn-ver-detalle[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 6px 20px #d4a57466;color:#1a1410}.empty-state[_ngcontent-%COMP%]{grid-column:1 / -1;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:5rem;opacity:.4;filter:drop-shadow(0 0 20px rgba(212,165,116,.2))}.empty-text[_ngcontent-%COMP%]{color:#b8a896;font-size:1.2rem;letter-spacing:.5px}.btn-empty-action[_ngcontent-%COMP%]{background:transparent;color:var(--bs-primary);border:1px solid rgba(212,165,116,.4);transition:all .3s ease}.btn-empty-action[_ngcontent-%COMP%]:hover{background:#d4a5741a;border-color:var(--bs-primary);transform:scale(1.05)}@media (max-width: 1199.98px){.decorative-corner[_ngcontent-%COMP%]{width:100px;height:100px}}@media (max-width: 991.98px){.decorative-corner[_ngcontent-%COMP%]{width:80px;height:80px}}@media (max-width: 767.98px){.decorative-corner[_ngcontent-%COMP%]{width:60px;height:60px}.corner-tl[_ngcontent-%COMP%], .corner-tr[_ngcontent-%COMP%]{top:10px}.corner-bl[_ngcontent-%COMP%], .corner-br[_ngcontent-%COMP%]{bottom:10px}.corner-tl[_ngcontent-%COMP%], .corner-bl[_ngcontent-%COMP%]{left:10px}.corner-tr[_ngcontent-%COMP%], .corner-br[_ngcontent-%COMP%]{right:10px}.comandas-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.2rem}}@media (max-width: 575.98px){.main-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}}']})};export{z as ComandasActivasComponent};
